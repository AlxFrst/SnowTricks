{% extends 'base.html.twig' %}

{% block title %}Nouvelle Figure
{% endblock %}

{% block body %}
	<div class="flex justify-center mt-4">
		<div class="w-full lg:w-2/3 p-5 shadow-lg bg-white rounded-lg">
			<h1 class="text-2xl font-semibold text-gray-800">Ajouter une Nouvelle Figure</h1>
			{{ form_start(form, {'attr': {'class': 'form-styling'}}) }}
			{{ form_errors(form) }}

			<div class="form-group">
				{{ form_row(form.name, {'attr': {'class': 'form-control', 'placeholder': 'Nom'}}) }}
			</div>

			<div class="form-group">
				{{ form_label(form.category) }}
				{{ form_widget(form.category, {'attr': {'class': 'form-control'}}) }}
			</div>

			<div class="form-group">
				{{ form_row(form.description, {'attr': {'class': 'form-control', 'placeholder': 'Description'}}) }}
			</div>

			<div class="add-elements">
				<button type="button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold rounded py-2 px-4 m-2" id="add_picture" data-collection="#pictures">Ajouter une Photo</button>
				<div id="pictures" class="flex flex-wrap py-2 justify-center">
					{% for picture in form.pictures %}
						<div class="w-1/3 p-1">
							{{ form_row(form.pictureName) }}
							{{ form_row(form.file) }}
							<div class="flex items-center">
								<button type="button" class="bg-red-500 text-white rounded py-2 px-4 ml-1">Supprimer</button>
							</div>

						</div>
					{% endfor %}
				</div>

				<button type="button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold rounded py-2 px-4 m-2 mt-auto" id="add_video" data-collection="#videos">Ajouter une Vidéo</button>
				<div id="videos" class="flex flex-wrap py-2">
					{% for video in form.video %}
						<div class="w-1/3 p-1">
							{{ form_row(form.videoName) }}
							{{ form_row(form.videoLink) }}
							<div class="flex items-center">
								<button type="button" class="bg-red-500 text-white rounded py-2 px-4 ml-1">Supprimer</button>
							</div>

						</div>
					{% endfor %}
				</div>
			</div>

			<button class="bg-green-500 hover:bg-green-700 text-white font-bold rounded py-2 px-4 m-2 mt-auto">{{ button_label|default('Enregistrer') }}</button>
			{{ form_end(form, {'render_rest': false}) }}

			<a class="inline-block bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-4" href="{{ path('app_trick_index') }}">Retour à l'Index</a>
		</div>
	</div>

	{# Ajout du script JavaScript #}
	{% verbatim %}
		<script>
			$(document).ready(function () {
if (document.querySelectorAll(".btn-add")) {

const addItem = (e) => {
const collectionHolder = document.querySelector(e.currentTarget.dataset.collection);

const item = document.createElement("div");
item.classList.add("col-4");

item.innerHTML = collectionHolder.dataset.prototype.replace(/__name__/g, collectionHolder.dataset.index);

item.querySelector('.btn-remove').addEventListener("click", () => item.remove());

collectionHolder.appendChild(item);
collectionHolder.dataset.index ++;
}

document.querySelectorAll('.btn-add').forEach(btn => btn.addEventListener('click', addItem));

document.querySelectorAll('.btn-remove').forEach(btn => btn.addEventListener("click", (e) => console.log(e.currentTarget.closest('.existing-item').remove())));
}
});
		</script>
	{% endverbatim %}

{% endblock %}
